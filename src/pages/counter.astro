---
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <main class="container">
    <h1>Counter</h1>
    <div id="hello">Not loaded</div>
    <div id="date-time">Not loaded</div>
    <div id="counter">Not loaded</div>
    <button id="increment">Increment</button>
  </main>
</Layout>

<script>
  import { actions } from "astro:actions";

  const { data } = await actions.hello({ name: "World" });
  const el = document.getElementById("hello");
  if (el) {
    el.textContent = data ?? "Null?";
  }

  const { data: dateData } = await actions.dateAndTime();
  const dateEl = document.getElementById("date-time");
  if (dateEl) {
    dateEl.textContent = dateData ?? "Null?";
  }

  const { data: counterData } = await actions.counter();
  const counterEl = document.getElementById("counter");
  if (counterEl) {
    counterEl.textContent = counterData?.toString() ?? "Null?";
  }

  const incrementButton = document.getElementById("increment");
  if (incrementButton) {
    incrementButton.addEventListener("click", async () => {
      const { data: newCounterData } = await actions.increment({});
      if (counterEl) {
        counterEl.textContent = newCounterData?.toString() ?? "Null?";
      }
    });
  }
</script>
